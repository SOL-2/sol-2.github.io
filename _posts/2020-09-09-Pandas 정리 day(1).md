---
title: "Pandas ì •ë¦¬ day(1)"
date: 2020-09-12 23:25:00 +0900
categories: Development



---

ì´ë²ˆì—” Pandasì— ëŒ€í•´ì„œ ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤.

ë¶ˆê³¼ ëª‡ ë‹¬ ì „ë§Œ í•´ë„ ì•„ì˜ˆ ì¡´ì¬ì¡°ì°¨ ëª°ëëŠ”ë° ë°°ìš¸ìˆ˜ë¡ ì‹ ê¸°í•˜ê³  ì–´ë µë‹¤...ğŸ˜‚ğŸ˜‚ğŸ˜‚



### 1. Pandasì˜ ìë£Œ êµ¬ì¡° - Series(1ì°¨ì›)

#### 1) Seriesì˜ ìƒì„±

PandasëŠ” NumPyì˜ ndarrayë¥¼ ê¸°ë³¸ ìë£Œ êµ¬ì¡°ë¡œ ì´ìš©í•˜ëŠ”ë°,

ì•„ë˜ì˜ Pandasë§Œì˜ ìë£Œêµ¬ì¡°ë¥¼ ì´ìš©í•œë‹¤.

* Series : ë™ì¼í•œ ë°ì´í„° íƒ€ì…ì˜ ë³µìˆ˜ê°œì˜ ì„±ë¶„ìœ¼ë¡œ êµ¬ì„±ë˜ëŠ” ìë£Œêµ¬ì¡° (1ì°¨ì›)
* DataFrame : ì—‘ì…€ì—ì„œ Tableê³¼ ê°™ì€ ê°œë…. Databaseì˜ Tableê³¼ ê°™ì€ ê°œë…. Seriesë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. (2ì°¨ì›)

ìš°ì„  1ì°¨ì› ìë£Œêµ¬ì¡°ì¸ Seriseì— ëŒ€í•´ ì•Œì•„ë³´ì!



ğŸ‘‡ndarrayì™€ Seriesì˜ í˜•íƒœë¥¼ ë¹„êµí•´ë³´ìğŸ‘‡

```python
import numpy as np
import pandas as pd

# ndarray
arr = np.array([-1, 4, 5, 99], dtype=np.float64)
print(arr)
# [-1.  4.  5. 99.]

# pandasì˜ Series
s = pd.Series([-1, 4, 5, 99], dtype=np.float64)
print(s)
# 0    -1.0
# 1     4.0
# 2     5.0
# 3    99.0
# dtype: float64
```

pandasì˜ SeriesëŠ” indexì™€ valueê¹Œì§€ ê°™ì´ returnë˜ë©° í•˜ë‹¨ì— ë°ì´í„° íƒ€ì…ê¹Œì§€ ëª…ì‹œëœë‹¤.

```python
print(s.values)  
# [-1.  4.  5. 99.] ndarray
print(s.index)   
# RangeIndex(start=0, stop=4, step=1) RangeIndexë¼ëŠ” í´ë˜ìŠ¤ê°ì²´
print(s.dtype)   
# float64
```

valueê°’ì€ ndarrayì˜ í˜•íƒœë¡œ ë°˜í™˜ë˜ì§€ë§Œ

indexëŠ” RangeIndexë¼ëŠ” í´ë˜ìŠ¤ê°ì²´ë¡œ ë°˜í™˜ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. 



#### 2) Seriesì˜ index & slicing

##### 2-1) index

Series ìƒì„± ì‹œ ê¸°ë³¸ì ìœ¼ë¡œ indexê°€ ìƒì„±ë˜ì§€ë§Œ listë¥¼ í™œìš©í•˜ì—¬ indexë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤.

```python
s = pd.Series([1, -8, 5, 10], 
              dtype=np.float64, 
              index=['c','b','a','k']) # index ì„¤ì •

print(s)
# c     1.0
# b    -8.0
# a     5.0
# k    10.0
# dtype: float64

# ê¸°ë³¸ì ìœ¼ë¡œ ìˆ«ì ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
print(s[0])   # 1.0

# ìˆ«ì ëŒ€ì‹  ë¦¬ìŠ¤íŠ¸ë¡œ ì§€ì •í•œ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
print(s['c']) # 1.0
```



ë§Œì•½ indexë¥¼ ì§€ì •í•´ì„œ ì‚¬ìš©í•  ë•Œ ê°™ì€ index, ì¦‰ ì¤‘ë³µì´ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ì–´ë–»ê²Œ ë ê¹Œ? ğŸ¤”

```python
s = pd.Series([1, -8, 5, 10], 
              dtype=np.float64, 
              index=['c','b','c','k'])

print(s)  

# ê°™ì€ ì¸ë±ìŠ¤ë¥¼ ë„£ì–´ë„ ì¶œë ¥ëœë‹¤!!

# c     1.0
# b    -8.0
# c     5.0
# k    10.0
# dtype: float64


# ì¤‘ë³µ ì¸ë±ìŠ¤ë¥¼ ì¶œë ¥í•˜ë©´?
print(s['c']) 

# c    1.0
# c    5.0
# dtype: float64

# ì „ë¶€ ë‹¤ ê°€ì ¸ì˜¤ê³ , Seriesë¡œ ë¦¬í„´í•œë‹¤
```



##### 2-2) slicing

Seriesì—ì„œë„ slicingì´ ê°€ëŠ¥í•˜ë‹¤.

```python
s = pd.Series([1, -8, 5, 10], 
              dtype=np.float64, 
              index=['c','b','c','k'])

# ìˆ«ìë¡œ slicing
print(s[1:3]) 
# b   -8.0
# c    5.0
# dtype: float64 -> # Seriesë¡œ ë¦¬í„´

# ì…ë ¥í•œ ë¬¸ìë¡œ slicing
print(s['b':'k']) 
# b    -8.0
# c     5.0
# k    10.0
# dtype: float64 

```

ê°™ì€ ìœ„ì¹˜ë¥¼ ìŠ¬ë¼ì´ì‹±í•´ë„ ìˆ«ìì™€ ë¬¸ìì— ë”°ë¼ ë¦¬í„´ë˜ëŠ” ê°’ì´ ë‹¬ëë‹¤.

ë¬¸ìì¸ë±ìŠ¤ëŠ” ì• ë’¤ ë‘˜ ë‹¤ í¬í•¨í•˜ê³  ìˆë‹¤.



#### 3) Boolean indexing & Fancy indexing

```python
s = pd.Series([1, -8, 5, 10], 
              dtype=np.float64, 
              index=['c','b','c','k'])

# # boolean indexing
print(s[s % 2 == 0]) # ì§ìˆ˜ë§Œ ì¶œë ¥

# b    -8.0
# k    10.0
# dtype: float64

# # Fancy indexing
print(s[[0,2,3]])

# c     1.0
# c     5.0
# k    10.0
# dtype: float64

print(s.sum())  # 8.0
```



 #### 4) ì—°ìŠµë¬¸ì œ ğŸ”¢

* Aê³µì¥ì˜ 2020-01-01ë¶€í„° 10ì¼ê°„ ìƒì‚°ëŸ‰ì„ Seriesë¡œ ì €ì¥

* ìƒì‚°ëŸ‰ì€ í‰ê· ì´ 50, í‘œì¤€í¸ì°¨ê°€ 5ì¸ ì •ê·œë¶„í¬ì—ì„œ ëœë¤í•˜ê²Œ ìƒì„±(ì •ìˆ˜ í˜•íƒœ)

* Bê³µì¥ì˜ 2020-01-01ë¶€í„° 10ì¼ê°„ ìƒì‚°ëŸ‰ Seriesë¡œ ì €ì¥

* ìƒì‚°ëŸ‰ í‰ê·  70, í‘œì¤€í¸ì°¨ê°€ 8ì¸ ì •ê·œ ë¶„í¬ì—ì„œ ëœë¤í•˜ê²Œ ìƒì„±(ì •ìˆ˜ í˜•íƒœ)

 `ì˜ˆì‹œ`

| Index      | Value |
| ---------- | ----- |
| 2020-01-01 | 53    |
| 2020-01-02 | 51    |

`í‘œ í˜•íƒœë¡œ ë³´ì—¬ì¡Œì§€ë§Œ pandasì˜ Seriesë¡œ ë³´ì—¬ì•¼ í•œë‹¤`



```python
import numpy as np
import pandas as pd

# ë‚ ì§œë¥¼ ë¶ˆëŸ¬ì˜¤ê¸° ìœ„í•œ ëª¨ë“ˆ
from datetime import date, datetime, timedelta

start_day = datetime(2020,1,1)
print(start_day)
# 2020-01-01 00:00:00 


# forë¬¸ì„ ì‘ì„±í•´ë³´ì 
# list comprehensionì„ í™œìš©í–ˆë‹¤
# í‘œì¤€ì •ê·œë¶„í¬ë¡œ ì¶”ì¶œí•˜ê³  ê°’ì€ ì •ìˆ˜ë¡œ ë‚˜ì™€ì•¼ í•˜ê¸° ë•Œë¬¸ì— intë¡œ í˜•ë³€í™˜ í•´ì¤€ë‹¤ 
# timedeltaë€ ë‚ ì§œë‚˜ ì‹œê°„ì˜ ì°¨ì´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°ì²´ë¥¼ í™œìš©í•˜ì—¬ ë‚ ì§œ ì¸ë±ìŠ¤ë¥¼ í‘œì‹œí•œë‹¤.

factory_A = pd.Series([int(x) for x in np.random.normal(50,5,(10,))],
                     index=[start_day + timedelta(days=x) for x in range(10)])



factory_B = pd.Series([int(x) for x in np.random.normal(70,8,(10,))],
                     index=[start_day + timedelta(days=x) for x in range(10)])

print(factory_A)
# 2020-01-01    57
# 2020-01-02    44
# 2020-01-03    53
# 2020-01-04    41
# 2020-01-05    54
# 2020-01-06    45
# 2020-01-07    48
# 2020-01-08    54
# 2020-01-09    47
# 2020-01-10    45
# dtype: int64

print(factory_B)
# 2020-01-01    62
# 2020-01-02    63
# 2020-01-03    74
# 2020-01-04    66
# 2020-01-05    78
# 2020-01-06    67
# 2020-01-07    75
# 2020-01-08    78
# 2020-01-09    84
# 2020-01-10    56
# dtype: int64
```

A ê³µì¥ê³¼ B ê³µì¥ì˜ ìƒì‚°ëŸ‰ì„ ë”í•˜ë ¤ë©´?

```python
print(factory_A + factory_B)

# ì¸ë±ìŠ¤ë³„ë¡œ ë”í•´ì§„ë‹¤!!
# ë§Œì•½ B ê³µì¥ì˜ ìƒì‚°ì¼ ì‹œì‘ì¼ì´ 1ì›” 5ì¼ë¶€í„°ë¼ë©´??

b_start_day = datetime(2020,1,5)
factory_B = pd.Series([int(x) for x in np.random.normal(70,8,(10,))],
                     index=[b_start_day + timedelta(days=x) for x in range(10)])

print(factory_A + factory_B)

# 2020-01-01      NaN
# 2020-01-02      NaN
# 2020-01-03      NaN
# 2020-01-04      NaN
# 2020-01-05    119.0
# 2020-01-06    119.0
# 2020-01-07    114.0
# 2020-01-08    126.0
# 2020-01-09    112.0
# 2020-01-10    114.0
# 2020-01-11      NaN
# 2020-01-12      NaN
# 2020-01-13      NaN
# 2020-01-14      NaN
# dtype: float64

# = > Seriesê°€ í•©ì§‘í•©ì´ ë˜ì–´ë²„ë¦°ë‹¤
```

Seriesì˜ indexê°€ ë‹¤ë¥´ë©´ í•©ì§‘í•©ìœ¼ë¡œ í•©ì³ë²„ë¦°ë‹¤ëŠ” ê²ƒì„ ìŠì§€ë§ì!!



#### 5) ê¸°íƒ€

##### 5-1) ì¸ë±ìŠ¤ ì¶”ê°€ ë° ì‚­ì œ

```python
# së¼ëŠ” Seriesë¥¼ í•˜ë‚˜ ìƒì„±í•˜ì

s = pd.Series([1,2,3,4])
print(s)

# 0    1
# 1    2
# 2    3
# 3    4
# dtype: int64

# 1) ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ Seriesì— ì¶”ê°€í•˜ë ¤ë©´? 
# -> ë‹¤ìŒ ì¸ë±ìŠ¤ë¥¼ í™œìš©í•´ ë°ì´í„°ë¥¼ ì¶”ê°€í•œë‹¤
s[4] = 100
print(s)

# 0      1
# 1      2
# 2      3
# 3      4
# 4    100
# dtype: int64

# 2) ì—°ì†ëœ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ë°ì´í„°ë¥¼ ì¶”ê°€í•œë‹¤ë©´?
# -> ERROR ë°œìƒí•˜ì§€ ì•Šê³  ìƒì„±ëœë‹¤
s[6] = 200

# 0      1
# 1      2
# 2      3
# 3      4
# 4    100
# 6    200
# dtype: int64

# 3) Seriesì—ì„œ íŠ¹ì • indexë¥¼ ì‚­ì œí•˜ë ¤ë©´?
# -> drop() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤
s = s.drop(2)
print(s)

# 0      1
# 1      2
# 3      4
# 4    100
# 6    200
# dtype: int64

```



##### 5-2) dictionaryë¥¼ ì´ìš©í•œ Series ìƒì„±

ndarrayë¿ë§Œ ì•„ë‹ˆë¼ dictionaryë¥¼ ì´ìš©í•´ì„œ Seriesë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ”ë°, dictionaryì˜ keyê°€ indexê°€ ëœë‹¤.

```python
my_dict = { 'ì„œìš¸':1000, 'ë¶€ì‚°':2000, 'ì œì£¼':3000 }

s = pd.Series(my_dict)
print(s)

# ì„œìš¸    1000
# ë¶€ì‚°    2000
# ì œì£¼    3000
# dtype: int64

# Seriesì™€ ì¸ë±ìŠ¤ì— ì´ë¦„ì„ ë¶€ì—¬í•  ìˆ˜ ìˆë‹¤

s.name = 'ì§€ì—­ë³„ ê°€ê²© ë°ì´í„°'
s.index.name = 'ì§€ì—­ëª…'
print(s)

# ì§€ì—­ëª…
# ì„œìš¸    1000
# ë¶€ì‚°    2000
# ì œì£¼    3000
# Name: ì§€ì—­ë³„ ê°€ê²© ë°ì´í„°, dtype: int64

```















