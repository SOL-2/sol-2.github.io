---

title: "NumPy ì •ë¦¬ day(1)"
date: 2020-09-7 23:46:00 +0900
categories: Development

---

Numpy moduleì„ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¹ì—°íˆ ëª¨ë“ˆ ì„¤ì¹˜ë¶€í„° í•´ì•¼í•œë‹¤.

ì‚¬ìš©í•˜ê³  ìˆëŠ” ê°€ìƒí™˜ê²½ì„ ì¼œê³  í•´ë‹¹ ê°€ìƒí™˜ê²½ì— ëª¨ë“ˆì„ ì„¤ì¹˜í•œë‹¤.

```bash
$ pip install numpy (ì¼ë°˜)
$ conda install numpy (ì•„ë‚˜ì½˜ë‹¤ ì‚¬ìš© ì‹œ)
```

ëª¨ë“ˆ ì„¤ì¹˜ë¥¼ ë§ˆì¹˜ê³  ì£¼í”¼í„° ë…¸íŠ¸ë¶ì—ì„œ ìƒˆ ë…¸íŠ¸ë¶ì„ ìƒì„±í•œë‹¤ ğŸ˜ƒ

![numpy_day1_1_jupyter](/assets/images/post/numpy_day1_1_jupyter.jpg)



### 1. ndarray ê¸°ì´ˆ ###

#### 1) ndarrayì˜ íŠ¹ì§• ####

ndarrayëŠ” íŒŒì´ì¬ì˜ listë¼ëŠ” ìë£Œêµ¬ì¡°ì™€ ë¹„ìŠ·í•œ ëª¨ìŠµì„ ê°€ì§€ê³  ìˆëŠ”ë°, ëª‡ê°€ì§€ ì°¨ì´ì ì´ ìˆë‹¤.

* ì¶œë ¥ ì‹œ í˜•íƒœê°€ ë‹¤ë¥´ë‹¤
* classê°€ ë‹¤ë¥´ë‹¤
* ndarrayëŠ” ë™ì¼í•œ ë°ì´í„°íƒ€ì…ìœ¼ë¡œë§Œ ë¬¶ì¼ ìˆ˜ ìˆë‹¤

```python

## numpyë¥¼ npë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ëœ»
import numpy as np  

a = [1,2,3,4,5]             # python list
print(a)                    # [1, 2, 3, 4, 5]
print(type(a))              # <class 'list'>


arr = np.array([1,2,3,4,5]) # Numpy ndarray
print(arr)                  # [1 2 3 4 5]
print(arr.dtype)            # <class 'numpy.ndarray'> 


arr = np.array([100, 3.14, True, 'Hello'])
print(arr)           
# ['100' '3.14' 'True' 'Hello']

```



#### 2) ë‹¤ì°¨ì› ndarray

íŒŒì´ì¬ì˜ listëŠ” ì¤‘ì²© ë¦¬ìŠ¤íŠ¸ë§Œ ì¡´ì¬í•˜ì§€ë§Œ ndarrayëŠ” ë‹¤ì°¨ì›ìœ¼ë¡œ ì¡´ì¬í•œë‹¤.

```python
a = [[1,2,3],[4,5,6]]   

arr = np.array(a)
print(arr)

# ì¤‘ì²©ë¦¬ìŠ¤íŠ¸ aë¥¼ ë„£ì–´ ndarray arrë¥¼ í”„ë¦°íŠ¸í•˜ë‹ˆ ë‹¤ì°¨ì›ìœ¼ë¡œ ë‚˜ì˜´
#[[1 2 3]
#[4 5 6]]

# ndarray arrì˜ 2,2ì˜ ì›ì†Œë¥¼ ì•Œê³  ì‹¶ë‹¤ë©´...?
# hint! listëŠ” 0ë¶€í„° ì„¼ë‹¤

print(arr[1,1])
# 5


# ndarrayì˜ ì›ì†Œë¥¼ ì‹¤ìˆ˜í˜•ìœ¼ë¡œ ë§Œë“¤ê³  ì‹¶ë‹¤ë©´?
a = [[1,2,3],[4,5,6]]   

arr = np.array(a, dtype=np.float64)
print(arr)

#[[1. 2. 3.]
# [4. 5. 6.]]
```



#### 3) ndarray ì°¨ì› ê´€ë ¨ ì†ì„±

```python
a = [1, 2, 3, 4]
arr = np.array(a, dtype=np.float64)

print(arr)  # [1. 2. 3. 4.]

# ndarrayì˜ ì°¨ì›ì˜ ê°¯ìˆ˜ë¥¼ í™•ì¸
print(arr.ndim)  # 1

# ndarrayì˜ ê° ì°¨ì›ì˜ ìš”ì†Œì˜ ê°¯ìˆ˜ë¥¼ tupleë¡œ í‘œí˜„
print(arr.shape) # (4,)


a = [[1,2,3],
     [4,5,6],
     [7,8,9],
     [10,11,12]]   

arr = np.array(a, dtype=np.float64)
print(arr)
print(arr.shape)  # (4, 3)
print(arr.ndim)   # 2

```



#### 4) ndarray í¬ê¸°

```python
a = [[1,2,3],[4,5,6],[7,8,9],[10,11,12]] 

arr = np.array(a, dtype=.float64)

print(arr)
#[[ 1.  2.  3.]
# [ 4.  5.  6.]
# [ 7.  8.  9.]
# [10. 11. 12.]]


# ndarrayì˜ ìš”ì†Œ ê°¯ìˆ˜
print(arr.size)  # 12

# ì²«ë²ˆì§¸ ì°¨ì›ì˜ ìš”ì†Œ ê°œìˆ˜ë¥¼ ë¦¬í„´(ì²«ë²ˆì§¸ í–‰ì˜ ê°¯ìˆ˜ë¥¼ ë¦¬í„´)
print(len(arr))  # 4

```



```python

# ì „ì²´ ì°¨ì›ì˜ ê°¯ìˆ˜ì™€ ê° ìš”ì†Œì˜ ê°¯ìˆ˜ë¥¼ ë¦¬í„´í•  ë•Œ!!!
print(arr.shape) # (4, 3)

# shapeì„ í™œìš©í•˜ì—¬ ndarrayë¥¼ ë°”ê¿€ ìˆ˜ë„ ìˆë‹¤
arr.shape = (2, 6)
print(arr)

# [[ 1.  2.  3.  4.  5.  6.]
#  [ 7.  8.  9. 10. 11. 12.]]


# ë‹¤ì°¨ì›ë„ ê°€ëŠ¥í•˜ë‹¤!!
arr.shape = (3,2,2)
print(arr)


# [[[ 1.  2.]
#  [ 3.  4.]]
#
# [[ 5.  6.]
#  [ 7.  8.]]
#
# [[ 9. 10.]
#  [11. 12.]]]

```



#### 5) ndarray ë°ì´í„° íƒ€ì… ë³€ê²½

astype( ) í•¨ìˆ˜ìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆë‹¤.

```python
arr = np.array([1.5, 2.3, 8.3, 9.3, 7.4], dtype=np.float64)
print(arr)  
# [1.5 2.3 8.3 9.3 7.4]


# ì •ìˆ˜íƒ€ì…ìœ¼ë¡œ ë³€ê²½í•˜ê¸°
result = arr.astype(np.int32)
print(result)
# [1 2 8 9 7]
```



### 2. ndarrayë¥¼ ë§Œë“œëŠ” ë°©ë²•

#### 1) ì›í•˜ëŠ” ìš”ì†Œë¡œ ì±„ìš°ëŠ” ë°©ë²•

```python
# 1) zeros : 0ìœ¼ë¡œ ì±„ìš´ numpy array
# shape ëª…ì‹œ, dtype np.float64ë¡œ ì§€ì •
arr = np.zeros((3,4)) 


# 2) ones : 1ë¡œ ì±„ìš´ numpy array
# shape ëª…ì‹œ, dtype np.float64ë¡œ ì§€ì •
arr = np.ones((2,5))


# 3) full : ì›í•˜ëŠ” ìˆ«ìë¡œ ì±„ìš°ëŠ” numpy array
# shape, ì›í•˜ëŠ” ìˆ«ì, dtype ìˆœìœ¼ë¡œ ëª…ì‹œ
arr = np.full((3,5),7, dtype=np.float64)


# 4) empty : ì›í•˜ëŠ” shapeì˜ ê³µê°„ë§Œ ì„¤ì •
# shapeë§Œ ëª…ì‹œ
arr = np.empty((3,3))


# 5) _like : ì§€ì •ëœ ë°°ì—´ê³¼ shapeì´ ê°™ì€ numpy array
a = np.array([[1,2,3],[4,5,6]])
b = np.ones_like(a)
print(b)

# [[1 1 1]
# [1 1 1]]


```



### 2) linspace

ê·¸ë˜í”„ë¡œ ë°ì´í„°ë¥¼ ê·¸ë ¤ë³´ê¸° ìœ„í•´ í•´ë‹¹ ê°€ìƒí™˜ê²½ì— matplotlibì„ ì„¤ì¹˜í•œë‹¤.

(seabornë„ ìˆë‹¤ê³  í•œë‹¤!!)

```python
import numpy as np
# matplotlibì˜ pyplotì„ pltë¡œ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ëœ»
import matplotlib.pyplot as plt


# np.linspace(start, stop, num)
# startë¶€í„° ì‹œì‘í•´ì„œ stopì˜ ë²”ìœ„ì—ì„œ numê°œì˜ ìˆ«ìë¥¼ ê· ì¼í•œ ê°„ê²©ìœ¼ë¡œ ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” ndarrayë¥¼ ë§Œë“œëŠ” í•¨ìˆ˜ë‹¤!!

arr = np.linspace(0,10,11)
print(arr)
# [ 0.  1.  2.  3.  4.  5.  6.  7.  8.  9. 10.]

# ìœ„ì˜ ndarrayëŠ” 0ë¶€í„° 10ê¹Œì§€ 11ë¡œ ê· ì¼í•˜ê²Œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

# ë§Œì•½ 1ë¶€í„° 121ê¹Œì§€ì˜ ë²”ìœ„ì—ì„œ 31ì˜ ê°„ê²©ìœ¼ë¡œ ìƒì„±í•´ì•¼ í•œë‹¤ë©´...??
arr = np.linspace(1, 121, 31)

# ê·¸ë˜í”„ë¡œ í™•ì¸í•˜ê¸°
plt.plot(arr, '*')
plt.show()
```

![numpy_day1_2_graph_1](/assets/images/post/numpy_day1_2_graph_1.jpg)



#### 3.1) ëœë¤ê°’ ê¸°ë°˜ ìƒì„±

```python
# 1) np.random.normal() 
# ì •ê·œë¶„í¬ í™•ë¥ ë°€ë„ í•¨ìˆ˜ì—ì„œ ì‹¤ìˆ˜ í‘œë³¸ì„ ì¶”ì¶œí•´ì„œ ndarray ìƒì„±í•œë‹¤
# í‰ê· , í‘œì¤€í¸ì°¨ê°€ ì¡´ì¬í•œë‹¤

# í‰ê·  : mean
# í‘œì¤€í¸ì°¨ : std

mean = 50
std = 2
arr = np.random.normal(mean,std,(100000,))
print(arr)
plt.hist(arr,bins=100)
plt.show()
```

![numpy_day_1_3_graph2](/assets/images/post/numpy_day_1_3_graph2.jpg)



```python
# 2) np.random.rand()
# 0ì´ìƒ 1ë¯¸ë§Œì˜ ì‹¤ìˆ˜ë¥¼ ì¶”ì¶œ 
# [0, 1) ë²”ìœ„ì—ì„œ ê· ë“±ë¶„í¬ë¡œ ì¶”ì¶œ

arr = np.random.rand(100000)
print(arr)
plt.hist(arr,bins=100)
plt.show()

```

![numpy_day_1_4_graph3](/assets/images/post/numpy_day_1_4_graph3.jpg)



```python
# 3) np.random.randn(d0,d1,d2...)
# ì‹¤ìˆ˜ì¶”ì¶œ, í‘œì¤€ì •ê·œë¶„í¬ì—ì„œ ë‚œìˆ˜ë¥¼ ì¶”ì¶œ
# í‰ê·  0, í‘œì¤€í¸ì°¨ 1

arr = np.random.randn(100000)
print(arr)
plt.hist(arr,bins=100)
plt.show()
```

![numpy_day_1_5_graph4](/assets/images/post/numpy_day_1_5_graph4.jpg)



```python
# 4) np.random.randint(low, high, shape)
# ê· ë“±ë¶„í¬
# í™•ë¥ ë°€ë„í•¨ìˆ˜ì—ì„œ ë‚œìˆ˜ ì¶”ì¶œ
# ì •ìˆ˜ê°’ì„ ë‚œìˆ˜ë¡œ ì¶”ì¶œ

arr = np.random.randint(-100,100,(100000,))
print(arr)
plt.hist(arr,bins=100)
plt.show()
```

![numpy_day_1_6_graph5](/assets/images/post/numpy_day_1_6_graph5.jpg)
{:.img_reduce}


```python
# 5) np.random.random(shape)
# 0 ì´ìƒ 1ë¯¸ë§Œ ê· ë“±ë¶„í¬ì—ì„œ ì‹¤ìˆ˜ ë‚œìˆ˜ ì¶”ì¶œ

arr = np.random.random((100000,))
print(arr)
plt.hist(arr,bins=100)
plt.show()
```

![numpy_day_1_7_graph6](/assets/images/post/numpy_day_1_7_graph6.jpg)





#### 3.2) ëœë¤ ê´€ë ¨ í•¨ìˆ˜

1) ë‚œìˆ˜ì˜ ì¬í˜„

ëœë¤ê°’ë„ íŠ¹ì • ì•Œê³ ë¦¬ì¦˜ì˜ ê²°ê³¼ë¬¼ì´ì–´ì„œ ì´ˆê¸° ì‹œì‘ê°’ì„ ì„¤ì •í•´ì£¼ë©´ í•­ìƒ ê°™ì€ ëœë¤ê°’ì´ ë„ì¶œëœë‹¤.

```python
np.random.seed(10)
arr = np.random.randint(0,100,(10,))
```



2) ndarray ìˆœì„œ ëœë¤í•˜ê²Œ ë°”ê¾¸ê¸°

Viewê°€ ì•„ë‹Œ ndarrayì˜ ë°ì´í„° ìš”ì†Œì˜ ìˆœì„œë¥¼ ë°”ê¾¸ëŠ” í•¨ìˆ˜ì´ë‹¤.

```python
arr = np.arange(10)
print(arr) # [0 1 2 3 4 5 6 7 8 9]

#ndarray ìì²´ê°€ ë³€í˜•ëœë‹¤
np.random.shuffle(arr)  
print(arr) # [8 0 3 9 5 7 1 4 6 2]
```



3) Sampling (ë¬´ì‘ìœ„ ì„ íƒ)

ndarray ì•ˆì—ì„œ ì¼ë¶€ë¥¼ ë¬´ì‘ìœ„ë¡œ ì„ íƒí•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤

```python
# np.random.choice(arr, size, replace, p)

# arr : numpy arrayê°€ ë‚˜ì˜¤ê±°ë‚˜ í˜¹ì€ ì •ìˆ˜ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆìŒ. ë§Œì•½ ì •ìˆ˜ë©´ arange(ì •ìˆ˜)
# size : ì •ìˆ˜ê°’ ìƒ˜í”Œì˜ ìˆ«ì
# replace : boolean(True, False)
#           True : í•œë²ˆ ì„ íƒí•œ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ìƒ˜í”Œë§í•  ìˆ˜ ìˆìŒ(ë‹¤ì‹œ ë½‘ì„ ìˆ˜ ìˆìŒ)
# p : í™•ë¥ , ndarray, ê° ë°ì´í„°ê°€ ê° ìƒ˜í”Œë§ë  í™•ë£°ì„ ê°€ì§€ê³  ìˆëŠ” ndarray

arr = np.random.choice(5, 10, replace=True, p=[0.2, 0, 0.3, 0.4, 0.1])
```

 

### 3. ndarray shape ì¡°ì ˆ í•¨ìˆ˜

shape ì†ì„±ì˜ ê°’ì„ ë°”ê¿”ì„œ ndarrayì˜ í˜•íƒœë¥¼ ë°”ê¿€ ìˆ˜ ìˆì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œëŠ” í•¨ìˆ˜ë¥¼ í™œìš©í•˜ì—¬ ì¡°ì ˆí•œë‹¤.

```python
# 1) reshape()
# reshape()ì€ ì§„ì§œ shapeì„ ë°”ê¾¸ëŠ” í•¨ìˆ˜ê°€ ì•„ë‹Œ, Viewë¥¼ ë°”ê¾¸ëŠ” í•¨ìˆ˜

arr = np.arnage(0,12,1) 
print(arr)
# 1ì°¨ì› ndarray
# [ 0  1  2  3  4  5  6  7  8  9 10 11]

arr1 = arr.reshape(4,3)
print(arr1)
# 4 x 3ì˜ 2ì°¨ì› ndarray
# [[ 0  1  2]
# [ 3  4  5]
# [ 6  7  8]
# [ 9 10 11]]

## arr[0] = 100 ìœ¼ë¡œ ë°”ê¾¼ë‹¤ë©´ arr1ì—ë„ ì˜í–¥ì´ ìˆì„ê¹Œ?
## ë°ì´í„°ê°’ì´ ë³€í•˜ë©´ ì˜í–¥ì„ ë°›ëŠ”ë‹¤
arr[0] = 100             
print(arr)
# [100   1   2   3   4   5   6   7   8   9  10  11]
print(arr1) 
# [[100   1   2]
# [  3   4   5]
# [  6   7   8]
# [  9  10  11]]
```



```python
# 2) ravel()
# ndarrayì˜ ëª¨ë“  ìš”ì†Œê°€ í¬í•¨ëœ 1ì°¨ì› vectorë¥¼ ë¦¬í„´í•œë‹¤
# Viewë¥¼ ë¦¬í„´í•œë‹¤


arr = np.arange(0, 20, 1).reshape(5, -1).copy()
print(arr)
# [[ 0  1  2  3  4  5  6  7  8  9]
# [10 11 12 13 14 15 16 17 18 19]]
arr1 = arr.ravel()
print(arr1)
# [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
```







